<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>button click animation | @codegrid</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
  </head>
  <body>
    <div class="copy">
      <p>
        In a future not too distant, <br />
        Codegrid forged a button drawer effect. <br />
        Design ethos / inspo by <br />
        x @kaihenthoiwane
      </p>
    </div>
    <div class="btn">
      <div class="send">
        <i class="ph ph-paper-plane-right"></i>
      </div>
      <div class="links">
        <div class="link" id="active">
          <div class="link-content">
            <a href="#">
              <i class="ph ph-sparkle"></i> &nbsp; Mute DM and let AI reply
            </a>
          </div>
        </div>
        <div class="link">
          <div class="link-content">
            <a href="#">
              <i class="ph ph-paper-plane-right"></i> &nbsp; Reply Normally
            </a>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const btn = document.querySelector(".btn");
        const sendIcon = document.querySelector(".send");
        const links = document.querySelector(".links");

        links.style.display = "none";
        const closedDimensions = {
          width: btn.offsetWidth,
          height: btn.offsetHeight,
        };

        links.style.display = "block";
        const openDimensions = {
          width: btn.offsetWidth,
          height: btn.offsetHeight,
        };

        gsap.set(links, { autoAlpha: 0 });
        gsap.set(sendIcon, { autoAlpha: 1 });
        btn.style.width = `${closedDimensions.width}px`;
        btn.style.height = `${closedDimensions.height}px`;

        let isOpen = false;

        const toggleMenu = () => {
          const timelineSettings = isOpen
            ? {
                btnSize: closedDimensions,
                alpha1: 0,
                alpha2: 1,
                scaleValue: 1,
                marginTop: 0,
              }
            : {
                btnSize: openDimensions,
                alpha1: 1,
                alpha2: 0,
                scaleValue: 0,
                marginTop: -btn.offsetHeight / 6,
              };

          const tl = gsap.timeline();
          tl.to(btn, {
            duration: 0.75,
            width: `${timelineSettings.btnSize.width}px`,
            height: timelineSettings.btnSize.height,
            ease: "elastic.out",
          })
            .to(
              sendIcon,
              {
                duration: 0.125,
                autoAlpha: timelineSettings.alpha2,
                scale: timelineSettings.scaleValue,
                marginTop: timelineSettings.marginTop,
              },
              0
            )
            .to(
              links,
              {
                duration: 0.2,
                autoAlpha: timelineSettings.alpha1,
                delay: isOpen ? -0.2 : 0.125,
              },
              0
            );

          isOpen = !isOpen;
        };

        btn.addEventListener("click", toggleMenu);
        links.querySelector(".link a").forEach((link) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            if (isOpen) toggleMenu();
          });
        });
      });
    </script>
  </body>
</html>
